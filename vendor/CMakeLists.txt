file(GLOB_RECURSE VENDOR_SRC RELATIVE "${PROJECT_SOURCE_DIR}/vendor" "*.c")
file(GLOB_RECURSE PCRE2_SRC RELATIVE "${PROJECT_SOURCE_DIR}/vendor" "oniguruma/*.c")
list(REMOVE_ITEM VENDOR_SRC ${PCRE2_SRC})
add_library(vendor "${VENDOR_SRC}")

target_compile_definitions(vendor
    PRIVATE 
    	SQLITE_ENABLE_COLUMN_METADATA=1
    	SQLITE_ENABLE_UNLOCK_NOTIFY
    	SQLITE_ENABLE_DBSTAT_VTAB=1
    	SQLITE_ENABLE_FTS3_TOKENIZER=1
    	SQLITE_SECURE_DELETE
    	SQLITE_MAX_VARIABLE_NUMBER=250000
    	SQLITE_MAX_EXPR_DEPTH=10000
    	SQLITE_ENABLE_FTS5
    	SQLITE_ENABLE_JSON1
    	SQLITE_ENABLE_RTREE
    	NDEBUG
        NO_FILES
    	NO_CGI
    	NO_SSL
    	NO_SSL_DL
    	SSL_ALREADY_INITIALIZED
        ZSTD_MULTITHREAD
)

if (UNIX_WITH_SUPPORT_COMPILERS)
    set(VENDOR_DEBUG_FLAGS -Og)
elseif (WIN32_WITH_MSVC)
    set(VENDOR_DEBUG_FLAGS)
endif()

target_compile_options(vendor PRIVATE "$<$<CONFIG:DEBUG>:${VENDOR_DEBUG_FLAGS}>")
add_subdirectory(oniguruma)